/* arrow-table.js - Copyright 2014 Gary Green. Licensed under the Apache License, Version 2.0 */!function(t,e){function n(t,e){this.init(t,e)}n.prototype={defaults:{namespace:"arrowtable",beforeMove:e.noop,afterMove:e.noop,listenTarget:"input",focusTarget:"input",enabledKeys:["left","right","up","down"],continuousDelay:50},KEYS:{37:"left",39:"right",38:"up",40:"down"},init:function(t,n){this.options=e.extend({},this.defaults,n),this.$table=e(t),this.bindEvents()},findMoveTarget:function(t,e){var n;switch(t){case"right":n=e.closest("td").next();break;case"left":n=e.closest("td").prev();break;case"down":n=e.closest("tr").next().find("td:eq("+e.closest("td").index()+")");break;case"up":n=e.closest("tr").prev().find("td:eq("+e.closest("td").index()+")")}return n},move:function(t,n){var i=e(t),s=e.proxy(function(){return this.findMoveTarget(n,i)},this),o=this.options.beforeMove(i[0],s,n);if(o!==!1){var r=s();r.length&&(this.focusTarget(r),this.options.afterMove(i[0],r[0],n))}},focusTarget:function(t){t.find(this.options.focusTarget).focus()},bindEvents:function(){var t,n=function(n){var i=this.KEYS[n.which];if(-1!==e.inArray(i,this.options.enabledKeys)){if(this.options.continuousDelay>0){if(t)return;t=setTimeout(function(){t=null},this.options.continuousDelay)}this.move(n.target,i)}},i=function(){t=null};this.$table.on("keydown."+this.options.namespace,this.options.listenTarget,e.proxy(n,this)).on("keyup."+this.options.namespace,this.options.listenTarget,i)},unbindEvents:function(){this.$table.off("."+this.options.namespace)},destroy:function(){return this.unbindEvents(),this}},e.fn.arrowTable=function(t){t=t||{};var i=t.namespace||n.prototype.defaults.namespace,s="string"==typeof t;return e(this).each(function(){var o=e(this),r=o.data(i);if(s){if(!r)return this;switch(t){case"destroy":r.destroy(),o.removeData(i)}return this}return void 0===r?(r=new n(this,t),o.data(i,r)):r.destroy().init(this,t),this})}}(window,jQuery);